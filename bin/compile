#!/bin/bash


# bin/compile BUILD_DIR CACHE_DIR ENV_DIR

# http://s3.amazonaws.com/downloads.basho.com/erlang/otp_src_R16B02-basho5.tar.gz

echo "-----> changing to the BUILD_DIR: $1"
cd $1

# http://docs.basho.com/riak/latest/quickstart/
echo "-----> downloading Erlang R16B02-basho5"

	curl -O http://s3.amazonaws.com/downloads.basho.com/erlang/otp_src_R16B02-basho5.tar.gz
	tar xvf otp_src_R16B02-basho5.tar.gz
	cd otp_src_R16B02-basho5

	echo "-----> installing Erlang"
	echo "-----> checking dependencies"
	sudo apt-get install build-essential libncurses5-dev openssl libssl-dev fop xsltproc unixodbc-dev

	echo "-----> building Erlang"
	./configure && make && sudo make install

	echo "-----> removing Erlang .tar.gz"
	rm otp_src_R16B02-basho5.tar.gz
	rm -fr otp_src_R16B02-basho5




echo "-----> building installing Riak: make rel from BUILD_DIR: $1"
make rel